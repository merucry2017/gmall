<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>支付</title>
        <link href="css\style.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="layui/css/layui.css">
        <script charset="utf-8" src="js\jquery-3.1.1.min.js"></script>
        <script src="layui/layui.js"></script>
    </head>
	<body>
    <div class="One_Jdbox">
      <div class="Jdbox_head">
        <img alt="" src="img\logo1.jpg">
        <ul>
          <li><span th:text="'你好,'+ ${nickname}"></span></li>
            <li><span>退出</span></li>
          <li>我的订单</li>
          <li>支付帮助</li>
        </ul>
      </div>
      <div class="Jdbox_BuySuc">
        <dl>

          <dd>
            <span th:text="'订单提交成功，请尽快付款！订单号：'+${outTradeNo}"> </span>
            <span th:text="'应付金额'+${totalAmount}+'元'"> </span>
          </dd>
          <dd>
            <span>推荐使用</span>
            <span>扫码支付请您在<font>24小时</font>内完成支付，否则订单会被自动取消(库存紧订单请参见详情页时限)</span>
            <span>订单详细</span>
          </dd>
        </dl>
      </div>
      <div class="Jd_Con">


        <div class="Jd_main">
          <ul>
            <li>
              <span>
                <input name="a" type="radio"  value="alipay" />
                <img alt="" src="img\alipay.jpg">支付宝
              </span>
            </li>
            <li>
              <span>
                <input name="a" type="radio"  value="mx" />
                <img alt="" src="img\weixin.png">微信支付
              </span>

            </li>
            <li>
            </li>
            <li>
            </li>
            <li>
              <button id="paymentButton">立即支付</button>
            </li>
          </ul>
        </div>
      </div>


    </div>

    <form id="paymentForm">
         <input name="totalAmount" th:value="${totalAmount}" type="hidden" >
         <input name="outTradeNo" th:value="${outTradeNo}" type="hidden" >
          <input id="token" name="token" type="hidden" value=""/>
    </form>


	</body>
  <script type="text/javascript">
      var token;
      $(document).ready(function () {
        token = getQueryVariable("token");
        $("#token").attr("value", token);
      })

      function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++) {
          var pair = vars[i].split("=");
          if(pair[0] == variable){ return decodeURIComponent(pair[1]);}
        }
        return(false);
      }


      $("#paymentButton").click(function () {
        $("#paymentForm").attr("action","/"+$("input[type='radio']:checked").val()+"/submit")  ;
        $("#paymentForm").submit();
        // var url = $("input[type='radio']:checked").val()+"/submit";
        // var loadingIndex = -1;
        // $.ajax({
        //   url:url,
        //   method:"POST",
        //   data:$("#paymentForm").serialize(),
        //   beforeSend : function () {
        //     //表单校验
        //     loadingIndex = layer.msg('处理中', {icon: 16});
        //     return true;
        //   },
        //   success : function(result){
        //     layer.close(loadingIndex);
        //     console.log(result);
        //     debugger
        //   },
        //   error : function(){
        //     layer.msg("支付失败！", {time: 1000, icon: 5, shift: 6});
        //   }
        // })
      })


      //立即支付按钮效果
      $("#paymentButton").mouseover(function(){
        $(this).css({"cursor":"pointer","background":"#FF5350"})
      }).mouseout(function(){
        $(this).css("background","#FC6E6C")
      })


  </script>
</html>
