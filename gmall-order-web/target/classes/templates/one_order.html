<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>谷米订单</title>
  <script src="/jquery/layer/layer.js" charset="utf-8"></script>
  <script src="layui/layui.js"></script>
  <link rel="stylesheet" type="text/css" href="layui/css/layui.css">
  <link rel="stylesheet" href="/css2/index.css">
  <style media="screen">
    * {
      font-family: "微软雅黑";
    }
  </style>
</head>

<body>
  <div id="nav">
    <nav>
      <div class="logo">
        <img src="img/logo2018.gif" alt="">
      </div>
      <div class="myjd">
        <h3>我的谷米</h3>
        <button onclick="returnIndex()">返回谷米首页</button>
      </div>
      <ul class="nav_ul">
        <li>首页</li>
        <li class="li hover">账户设置<i class="ul_i"></i>
          <ol>
            <li>个人信息</li>
            <li>账户安全</li>
            <li>我的尺码</li>
            <li>账号绑定</li>
            <li>收货地址</li>
            <li>用药人信息</li>
            <li>分享绑定</li>
            <li>邮件订阅</li>
            <li>应用授权</li>
            <li>快捷支付</li>
            <li>增票资质</li>
            <li>企业发票</li>
            <li>采购需求单</li>
          </ol>
        </li>
        <li class="li">社区<i class="ul_i"></i>
          <ol>
            <li>个人主页</li>
            <li>我的活动</li>
            <li>我的圈子</li>
            <li>我的帖子</li>
          </ol>
        </li>
        <li>消息</li>
      </ul>
      <div class="right">
        <div class="btn">
          <input type="text" placeholder="空调"><button>搜索</button>
        </div>
        <ul class="shop">
          <li><i class="shop_che"></i>我的购物车 >
            <ol>
              <li>
                <img src="img/shop.png" alt="">
                <div>购物车中还没有商品，赶紧选购吧</div>
                <div style="clear:both;"></div>
              </li>
            </ol>
          </li>
        </ul>
      </div>
      <div style="clear:both;"></div>
    </nav>

  </div>
  <div style="clear:both;"></div>
  <div id="big">
    <div id="one_order_bigLeft" th:include="one_order_bigLeft"></div>
    <div id="bigRight">
      <div class="myOrder">
        <p>我的订单</p>
      </div>


      <div class="allBig">
        <div class="allOrder">
          <ul class="allOrderTop">
            <li>
              <ol>
                <li>全部订单</li>
                <li>待付款</li>
                <li>待收货</li>
                <li>待评价</li>
                <div style="clear:both;"></div>
              </ol>
            </li>
            <li class="allOrderTopLi">我的常购商品</li>
            <li class="allOrderTopLi">好货清仓</li>
            <li class="allOrderTopLastLi">
              <span>订单回收站</span>
              <div>
                <input type="text" placeholder="商品名称/商品编号/订单号"><button class="search"></button><button calss="gao">高级<i></i></button>
              </div>
            </li>
            <div class="clear:both;"></div>
          </ul>

        </div>
        <div class="details">
          <ul class="detailsUl">
            <div class="detailsUlDiv">
              <li class="detailsLiok detailsLi">近三个月订单<i class="allBig_i"></i>
                <ol>
                  <li>近三个月订单</li>
                  <li>今年内订单</li>
                  <li>今年内订单</li>
                  <li>2016年订单</li>
                  <li>2015年订单</li>
                  <li>2014年订单</li>
                  <li>2014年以前订单</li>
                </ol>
              </li>
              <li class="detailsLi">订单详情</li>
              <div style="clear:both;"></div>
            </div>

            <li class="detailsLi1">收货人</li>
            <li class="detailsLi1">金额</li>
            <li class="detailsLi1 detailsLiok">全部状态<i class="allBig_i"></i>
              <ol>
                <li>全部状态</li>
                <li>等待付款</li>
                <li>等待收货</li>
                <li>已完成</li>
                <li>已取消</li>
              </ol>
            </li>
            <li class="detailsLi1">操作</li>
            <div style="clear:both;"></div>
          </ul>
        </div>


        <table class="table" th:each="omsOrderInfo:${omsOrderInfos}">
          <tr>
            <td colspan="7" rowspan="1" style="background:#F7F7F7" >
              <span style="color:#AAAAAA" th:text="${omsOrderInfo.createTime}">2017-12-09 20:50:10</span>
              <span th:text="${omsOrderInfo.orderSn}"><ruby style="color:#AAAAAA">订单号:</ruby> 70207298274</span>
              <span>谷米官方旗舰店<i class="table_i"></i></span>
              <i th:onclick="'deleteOrderById('+${omsOrderInfo.id}+')'" class="table_i5 isShow"></i>
            </td>
          </tr>
          <tr class="tr">

            <td colspan="3">
              <table>
                <tr th:each="omsOrderItem:${omsOrderInfo.orderItems}">
                  <img th:src="${omsOrderItem.productPic}" alt="" class="img" style="width: 80px;height: 100px">
                  <div>
                    <p th:text="${omsOrderItem.productName}">MUXIWEIERPU皮手套男冬季加绒保暖户外骑<br />
                    车开车触摸屏全指防寒全指手套 黑色 均码</p>
                    <div><i class="table_i4"></i>找搭配</div>
                  </div>
                  <div style="margin-left:15px;" th:text="'X'+${omsOrderItem.productQuantity}">x1</div>
                  <div style="clear:both"></div>
                </tr>
              </table>
            </td>
            <td th:text="${omsOrderInfo.memberUsername}">张三<i><i class="table_i1"></i></i></td>
            <td style="padding-left:10px;color:#AAAAB1;">
              <p style="margin-bottom:5px;" th:text="'总额 ￥'+${omsOrderInfo.totalAmount}">总额 ￥26.00</p>
              <hr style="width:90%;">
              <p th:text="'支付方式：'+${omsOrderInfo.payTypeValue}">在线支付</p>
            </td>
            <td>
              <ul>
                <li style="color:#71B247;" th:text="${omsOrderInfo.statusValue}">等待收货</li>
                <li style="margin:4px 0;" class="hide"><i class="table_i2"></i>跟踪<i class="table_i3"></i>
                    <div class="hi">
                      <div class="p-tit">
                        普通快递   运单号:390085324974
                      </div>
                      <div class="hideList">
                        <ul>
                          <li>
                            [北京市] 在北京昌平区南口公司进行签收扫描,快件已被拍照(您
                            的快件已签收,感谢您使用韵达快递)签收
                          </li>
                          <li>
                            [北京市] 在北京昌平区南口公司进行签收扫描,快件已被拍照(您
                            的快件已签收,感谢您使用韵达快递)签收
                          </li>
                          <li>
                            [北京昌平区南口公司] 在北京昌平区南口公司进行派件扫描
                          </li>
                          <li>
                            [北京市] 在北京昌平区南口公司进行派件扫描;派送业务员:业务员;联系电话:17319268636
                          </li>
                        </ul>
                      </div>
                    </div>
                </li>
                <li class="tdLi">订单详情</li>
              </ul>
            </td>
            <td>
              <button>确认收货</button>
              <p style="margin:4px 0; ">取消订单</p>
              <p>催单</p>
            </td>
          </tr>
        </table>

        <div class="order_btm">
          <div>
            <button>上一页</button>
            <span>1</span>
            <button>下一页</button>
          </div>
        </div>
        <div style="clear:both;"></div>
      </div>

      <!-- 广告模块  -->
      <div id="one_order_advt" th:include="one_order_advt"></div>
      <div id="logo">
        <img src="img/datu.jpg" alt="">
        <img src="img/datu1.jpg" alt="">
      </div>
    </div>
    <div style="clear:both;"></div>
  </div>
  <!-- 页面底部 -->
  <div id="one_order_footer" th:include="one_order_footer"></div>

</body>
<script src="js/jquery-3.1.1.min.js"></script>
<script src="js/index.js"></script>
<script type="text/javascript">
  var token, nickname;
  $(document).ready(function () {
    token = getQueryVariable("token");
    nickname = getQueryVariable("nickname");
  })

  // 获取url中的参数
  function getQueryVariable(variable) {
    var query = window.location.search.substring(1);
    var vars = query.split("&");
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split("=");
      if (pair[0] == variable) {
        return pair[1];
      }
    }
    return false;
  }

  // 根据订单单号删除订单
  function deleteOrderById(orderId) {
    var loadingIndex = -1;
    $.ajax({
      type : "DELETE",
      url : "deleteOrderById?orderId="+orderId,
      beforeSend : function () {
        //表单校验
        loadingIndex = layer.msg('处理中', {icon: 16});
      },
      success : function(result){
        layer.close(loadingIndex);
        if(result.success){
          layer.msg("订单删除成功！", {time:3000, icon: 6, shift: 6})
          location.reload();
        }else{
          layer.msg(result.message , {time: 3000, icon: 5, shift: 6});
        }
      },
      error : function(){
        layer.msg("删除失败！", {time: 3000, icon: 5, shift: 6});
      }
    });
  }

  function returnIndex() {
      window.location.href = "http://search.gmall.com:8083/index?token="+token+"&nickname="+nickname;
  }
</script>
</html>
